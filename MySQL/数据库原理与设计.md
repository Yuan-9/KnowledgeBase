# 数据库原理与设计 核心问题

## 第1章 数据库系统引论

**简述数据管理的不同阶段特点**

1. 人工管理阶段（1940s-1950s） 特点：

- 数据不保存；
- 没有专用的软件管理数据；
- 应用程序完全依赖于数据；
- 数据不能共享。

2. 文件系统阶段（1950s末-1960s中） 特点：

- 数据可以长期保存；
- 有专门的文件系统软件管理数据；
- 数据是面向应用的；
- 数据冗余度大；
- 缺乏对数据统一的控制机制。

3. 数据库系统阶段（1960s末至今） 特点：

- 数据结构化；
- 数据独立性高，包括物理独立性和逻辑独立性；
- 减少数据冗余，数据面向系统且集中管理；
- 数据共享，作为数据库发展的主要原因和重要特征；
- 统一的数据保护功能。

**简述数据、数据库、数据库管理系统、数据库系统的概念及四者之间的关系**

1. 数据：数据是描述客观事物的符号或者量化的信息，可以是数字、文字、图形、音频、视频等。数据是数据库中的基本元素，用于表示现实世界中的实体和它们之间的关系。
2. 数据库：数据库是一个长期存储在计算机内、有组织的数据集合。它根据数据间的联系组织在一起，具有较高的数据独立性，较少数据冗余，并且能够为各种用户共享。
3. 数据库管理系统（DBMS）：数据库管理系统是用于管理数据库的软件系统。它的主要功能包括数据的存储、组织、检索、更新、安全性管理等。DBMS使用户能够方便地创建、维护和访问数据库。
4. 数据库系统：数据库系统是由数据库、数据库管理系统、应用程序和数据库管理员（DBA）组成的一个集成环境。数据库系统的目标是使用户能够高效地存储、管理和检索数据。

四者之间的关系：

- 数据是数据库的基本构成元素，数据库就是存放数据的仓库；
- 数据库管理系统（DBMS）是用于管理数据库的软件，负责对数据库进行操作和维护；
- 数据库系统是一个包括数据库、数据库管理系统、应用程序和数据库管理员在内的整体环境，使用户能够高效地存储、管理和检索数据。

**简述什么是数据库三级模式以及与数据独立性之间的关系**

数据库三级模式是一种数据库架构设计，用于描述和组织数据以支持数据独立性。数据库三级模式包括以下三个层次：

1. 外模式（External Schema）：外模式是针对特定用户或应用程序的数据视图，描述了特定用户或应用程序如何看待数据。一个数据库可以有多个外模式，满足不同用户的应用需求、数据访问方式和保密要求。
2. 模式（Schema，也称为逻辑模式）：模式是整个数据库的逻辑结构和特征的描述，构成了数据库的一个总的框架。一个数据库对应一个模式。模式独立于应用程序和物理存储。
3. 内模式（Internal Schema，也称为存储模式）：内模式描述了数据在数据库内部的物理结构和存储方式。它规定了数据在存储介质上的物理组织方式、记录寻址方式等。一个数据库只能有一个内模式。

数据库三级模式与数据独立性的关系：

1. 逻辑独立性：外模式与模式之间的映像定义局部数据逻辑结构与全局逻辑结构之间的对应关系。当模式结构改变时，只需修改外模式与模式间的对应关系，而不必修改外模式中的局部逻辑结构，从而使应用程序保持不变。这实现了数据的逻辑独立性。
2. 物理独立性：模式与内模式之间的映像定义全局数据逻辑结构和物理数据存储间的对应关系。当数据库的物理存储结构改变时，仅需修改模式与内模式间的映像关系，而可以使模式保持不变，从而使应用程序保持不变。这提供了数据的物理独立性。

通过数据库三级模式结构，用户能够逻辑抽象地处理数据，而无需关心数据在计算机中的内部表示。同时，数据的存储也无需考虑用户对数据的使用，数据的具体组织由数据库管理系统（DBMS）管理。这有助于实现数据的逻辑和物理独立性，提高数据库系统的灵活性和可维护性。

**什么是数据模型？**

数据模型是一种对现实世界中事物及其关系进行抽象和表达的方法，用于描述和组织数据的一组概念和定义。数据模型包括以下三个部分：

1. 数据结构：数据结构是数据模型中对数据静态特性的描述，包括应用所涉及的对象、对象具有的特征以及对象之间的联系。
2. 数据操作：数据操作是数据模型中对数据动态特性的描述，包括对数据库中对象实例执行的一组操作，如检索、插入、删除和修改等。
3. 数据的完整性约束：数据的完整性约束是对数据静态和动态特性的限定，反映了数据间的制约和依存关系。

## 第2章 数据模型

**试分别举出事物间具有一对一、一对多、多对多联系的三个例子**

一对一（1:1）联系的例子：班级与班长之间的联系：一个班级只有一个正班长，一个班长只在一个班中任职

一对多（1:n）联系的例子： 班级与学生之间的联系：一个班级中有若干名学生，每个学生只在一个班级中学习 

多对多（m:n）联系的例子： 课程与学生之间的联系：一门课程同时有若干个学生选修，一个学生可以同时选修多门课程

## 第3章 关系数据库

## 第4章 关系数据库标准语言SQL

## 第5章 查询处理和查询优化

**列举几种典型的连接实现算法？**

嵌套循环法：嵌套循环法是最简单、最直接的连接算法，与选择操作中的顺序扫描法类似，不需要特别的存取路径。一般使用较少块的文件作为外循环文件连接代价较小。嵌套循环法适用于任何条件的连接 

索引嵌套循环法：如果两个连接属性中的一个属性上存在索引（或散列），可以使用索引扫描代替顺序扫描。

排序合并法：适合连接的诸表已经排好序的情况

散列连接法：把连接属性作为hash码，用同一个hash函数把R和S中的元组散列到同一个hash文件中

**查询优化技术都有哪些？**

代数优化：是关系代数表达式的优化，即按照一定的规则改变代数表达式中操作的次序和组合，使查询执行更高效。不涉及底层的存取路径
基于存取路径的优化：合理选择各种操作的存取路径以获得优化效果，需要考虑数据的物理组织和访问路径，以及底层操作算法的选择，涉及数据文件的组织方法、数据值的分布情况等，也称为物理优化
基于代价估算的优化：对于多个可选的查询策略通过估算执行策略的代价，从中选择代价最小的作为执行策略

## 第6章 数据库的安全性

**简述实现数据库安全性控制的常用方法和技术？**

用户标识与鉴别：该方法由系统提供一定的方式让用户标识自己的名字或身份。用户进入系统时，由系统进行核对，通过鉴定后才提供系统的使用权。最外层的安全保护措施 。

存取控制：通过用户权限定义和合法权检查确保只有合法权限的用户访问数据库，所有未被授权的人员无法存取数据。 

视图机制：为不同的用户定义视图，通过视图机制把要保密的数据对无权存取的用户隐藏起来，从而自动地对数据提供一定程度的安全保护 。

数据加密：对存储和传输的数据进行加密处理，从而使得不知道解密算法的人无法获知数据的内容。

数据库审计：数据库审计可以作为预防手段，建立审计日志，把用户对数据库的所有操作自动记录下来放入审计日志中，DBA 可以利用审计跟踪的信息，重现导致数据库现有状况的一系列事件，找出非法存取数据的人、时间和内容等。

**什么是自主存储控制和强制存储控制？**

自主存取控制（DAC）： 自主存取控制是一种基于用户身份或用户所属角色来决定数据访问权限的方法。在DAC中，数据的所有者或管理员可以根据需要，自由地授权或撤销其他用户对数据的访问权限。这种控制策略的特点是灵活性较强，可以根据实际需求进行调整。DAC通常通过SQL的GRANT（授权）和REVOKE（撤销）语句来实现。

强制存取控制（MAC）： 强制存取控制是一种更严格的访问控制机制，其基于预先设定的安全策略来决定用户对数据的访问权限。在MAC中，每个数据对象都被赋予一个密级（security level），同时每个用户也被授予一个许可证级别（clearance level）。用户只有在其许可证级别满足特定条件时，才能访问相应的数据对象。MAC的规则如下：

1. 仅当主体（用户）的许可证级别大于或等于客体（数据对象）的密级时，该主体才能读取相应的客体。
2. 仅当主体的许可证级别等于客体的密级时，该主体才能写相应的客体。

**为什么强制存取控制提供了更高级别的数据库的安全性？**

强制存取控制（MAC ）是对数据本身进行密级标记，无论数据如何复制，标记与数据是一个不可分的整体，只有符合密级标记要求的用户才可以操纵数据，从而提供了更高级别的安全性。

**举例说明如何把视图机制作为一种授权机制使用？**

视图（View）是数据库中虚拟表的一种表示，它基于一个或多个基本表（Base Table）的结果集。视图并不实际存储数据，而是通过查询基本表来获取数据。因此，视图可以作为一种授权机制使用，对用户访问基本表数据施加限制，从而保护敏感数据的安全性。

以下是一个例子，说明如何将视图机制作为授权机制使用：

假设有一个员工表（employees），表中包含员工的ID、姓名、职位、薪资等信息。为了保护员工的隐私，我们希望限制部分用户只能访问员工的ID、姓名和职位，而无法查看薪资信息。此时，可以通过创建一个视图来实现这一需求。

1. 创建视图： 首先，创建一个基于员工表的视图，仅包含ID、姓名和职位列：

```sql
CREATE VIEW employee_basic_info AS
SELECT employee_id, name, position
FROM employees;
```

1. 授权访问： 接下来，为需要访问员工基本信息的用户（例如，user1）授权访问新创建的视图：

```sql
GRANT SELECT ON employee_basic_info TO user1;
```

现在，user1可以查询视图employee_basic_info来获取员工的ID、姓名和职位信息，但无法访问薪资信息。这是因为视图机制将对基本表数据的访问限制在了特定的列上，实现了一种基于列的访问控制。

## 第7章 数据库的完整性

**什么是数据库的完整性？**

数据的完整性是指数据的正确性、有效性和相容性

数据库完整性主要包括以下几种类型：

1. **实体完整性**：实体完整性确保每个表具有唯一的主键，用于唯一地标识表中的每一行。主键的值不能为空（null），也不能重复。
2. **参照完整性**：参照完整性涉及到数据库中表之间的关系。当一个表中的外键引用另一个表中的主键时，参照完整性要求外键必须引用一个已经存在的主键值，或者可以为空（null），这取决于具体的设计需求。参照完整性保证了在相关表之间保持数据一致性。
3. **用户定义完整性**：用户定义完整性包括根据特定业务规则和需求定制的完整性约束。这些约束可以包括触发器、存储过程、自定义函数和其他数据库对象，以确保在执行操作时满足这些业务规则。

**在关系数据库系统中，当操作违反实体完整性、参照完整性约束条件时，系统一般是如何进行处理的？**

**实体完整性**：如果操作试图插入一个已存在的主键值，或者插入一个包含空（null）主键值的记录，数据库系统将拒绝执行操作并返回一个错误。

**参照完整性**：当违反参照完整性时，数据库系统的处理方式如下：

1. **拒绝执行（NO ACTION）**：这是默认行为。当操作违反参照完整性时，数据库系统将拒绝执行操作并返回一个错误。用户需要更正操作以满足参照完整性要求。
2. **级联操作（CASCADE）**：当父表中的记录被更新或删除时，与之关联的子表中的记录将自动进行相应的更新或删除操作。例如，如果在父表中删除一个记录，子表中引用该父记录的所有记录也将被删除。
3. **设置为空值（SET NULL）**：当父表中的记录被更新或删除时，与之关联的子表中的记录将自动将其外键值设置为NULL。这种情况下，子表中的记录不会被删除，但会失去与父表的关联。注意，这要求子表中的外键列允许NULL值。

## 第8章 数据库恢复技术

## 第9章 并发控制

## 第10章 关系数据库设计理论

